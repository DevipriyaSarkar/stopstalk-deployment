{{extend 'layout.html'}}
<script src="{{=URL('static', 'js/jquery.bootpag.min.js')}}"></script>
<style>
    #refresh-submissions {
        margin-right: 4%;
    }
</style>
<script>
    var clearSession = function() {
        sessionStorage.clear();
        window.location.href = "";
    }
    $(function() {

        var currentURL = window.location.href,
            handle,
            page,
            index;

        index = currentURL.indexOf("=");
        if (index == -1) {
            page = "1";
        }
        else {
            page = currentURL.slice(index + 1);
        }

        handle = currentURL.split("/").splice(-1)[0];
        handle = handle.split("?")[0];
        if (handle == "submissions") {
            handle = "";
        }

        $.ajax({
            method: 'GET',
            url: '{{=URL("user", "submissions", extension="json")}}' + "/" + handle + "?page=" + page
        }).done(function(response) {

            var pageCount = response['page_count'];
            $('#page-selection').bootpag({
                total: pageCount,
                page: parseInt(page),
                maxVisible: 10
            }).on("page", function(event, num) {
                window.location.href = "{{=URL('user', 'submissions')}}" + "/" + handle + "?page=" + num.toString();
            });

        });

    });
</script>
{{if user == "Self":}}
    <h1>Your submissions</h1>
{{else:}}
    <h1>Submissions of {{=user}}</h1>
{{pass}}
<div id="page-selection" class="center"></div>
<div id="id_custom" style="display: none;">{{=user_id}} {{=c}}</div>
{{=table}}
