{{extend 'layout.html'}}
<script src="{{=URL('static', 'js/jquery.bootpag.min.js')}}"></script>
<h1>Recent submissions</h1>
<div id="page-selection" class="center"></div>
<div id="content"></div>
    <script>
        $(function() {
            var check = function(user_count, flen, clen) {
                if (user_count == flen + clen) {
                    return true;
                }
                return false;
            }

            $.ajax({
                method: 'GET',
                url: '{{=URL("default", "submissions", extension="json")}}'
            }).done(function(page) {
                var pageCount = page['count'];
                var friends = page['friends'];
                var cfriends = page['cusfriends'];

                var currentUrl = window.location.href;
                currentUrl = currentUrl.split("/").slice(-1);
                var currPage;
                if (currentUrl != "submissions") {
                    currPage = currentUrl;
                } else {
                    currPage = "1";
                }
                $('#page-selection').bootpag({
                    total: pageCount,
                    page: parseInt(currPage),
                    maxVisible: 10
                }).on("page", function(event, num) {
                    window.location.href = '{{=URL("default", "submissions")}}' + "/" + num.toString();
                });
            });
        });
    </script>
{{=table}}
